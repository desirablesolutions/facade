{"version":3,"sources":["../../src/models/db.ts"],"sourcesContent":["import { define } from \"../build/index\"\r\n\r\nexport interface IBlackprintModule { }\r\nexport interface IBlackprintDatabaseModule<T> extends IBlackprintModule {\r\n    T\r\n}\r\n\r\n\r\nconst db = define(() => {\r\n\r\n    const lib = {\r\n        defineViewStore: ({ layout, pages }) => {\r\n            return {\r\n                layout, pages, meta: {\r\n                    version: Date.now()\r\n                }\r\n            };\r\n\r\n        },\r\n        defineDatabaseCollection: ({ meta, shape, methods }: { meta?: any, shape?: any, methods?: any }) => {\r\n            return function (store) {\r\n                return {\r\n                    data: shape(store),\r\n                    methods,\r\n                    meta\r\n                }\r\n            }\r\n        },\r\n        defineDatabase: async (databaseConfig: any) => {\r\n\r\n            const { init: store, params, rest } = await databaseConfig()\r\n\r\n            const collections = Object.fromEntries(\r\n                Object.entries(params.collections)\r\n                    .map(([name, methods]: [string, Function]) => {\r\n                        let test = methods(store).data\r\n                        return [\r\n                            name,\r\n                            test\r\n                        ]\r\n                    }))\r\n\r\n\r\n            return { collections, rest, store };\r\n        },\r\n\r\n\r\n        defineDatabaseMethod: ({ filters }: { filters?: Array<any> }) => {\r\n            return function ({ store }: { store: Array<any> }) {\r\n                return store\r\n            }\r\n        },\r\n    }\r\n\r\n    return lib\r\n})\r\n\r\nexport default db"],"mappings":"qCAQA,IAAMA,EAAKC,EAAO,KAEF,CACR,gBAAiB,CAAC,CAAE,OAAAC,EAAQ,MAAAC,CAAM,KACvB,CACH,OAAAD,EAAQ,MAAAC,EAAO,KAAM,CACjB,QAAS,KAAK,IAAI,CACtB,CACJ,GAGJ,yBAA0B,CAAC,CAAE,KAAAC,EAAM,MAAAC,EAAO,QAAAC,CAAQ,IACvC,SAAUC,EAAO,CACpB,MAAO,CACH,KAAMF,EAAME,CAAK,EACjB,QAAAD,EACA,KAAAF,CACJ,CACJ,EAEJ,eAAgB,MAAOI,GAAwB,CAE3C,GAAM,CAAE,KAAMD,EAAO,OAAAE,EAAQ,KAAAC,CAAK,EAAI,MAAMF,EAAe,EAa3D,MAAO,CAAE,YAXW,OAAO,YACvB,OAAO,QAAQC,EAAO,WAAW,EAC5B,IAAI,CAAC,CAACE,EAAML,CAAO,IAA0B,CAC1C,IAAIM,EAAON,EAAQC,CAAK,EAAE,KAC1B,MAAO,CACHI,EACAC,CACJ,CACJ,CAAC,CAAC,EAGY,KAAAF,EAAM,MAAAH,CAAM,CACtC,EAGA,qBAAsB,CAAC,CAAE,QAAAM,CAAQ,IACtB,SAAU,CAAE,MAAAN,CAAM,EAA0B,CAC/C,OAAOA,CACX,CAER,EAGH,EAEMO,EAAQd","names":["db","define","layout","pages","meta","shape","methods","store","databaseConfig","params","rest","name","test","filters","db_default"]}